@page "{id:int?}"

@model FoodAndStyleOrderPlanning.Pages.Products.EditModel
@{
    ViewData["Title"] = "Προϊόν";
}
<form method="post">

    <input type="hidden" asp-for="ProductViewModel.Id" />
    <div class="form-group">
        <label asp-for="ProductViewModel.Name">'Ονομα</label>
        <input asp-for="ProductViewModel.Name" class="form-control" />
        <span class="text-danger" asp-validation-for="ProductViewModel.Name"></span>
    </div>
    <div class="form-group">
        <label asp-for="ProductViewModel.Quality">Ποιότητα</label>
        <input asp-for="ProductViewModel.Quality" class="form-control" />
        <span class="text-danger" asp-validation-for="ProductViewModel.Quality"></span>
    </div>

    <div class="form-group">
        <label asp-for="ProductViewModel.MeasuringUnit">Μονάδα Μέτρησης</label>
        <select class="form-control" onchange="removeChoiceOption(this);" asp-for="ProductViewModel.MeasuringUnit" asp-items="Model.MeasuringUnit">
            <option disabled value="-1">--- Επιλογή ---</option>
        </select>
    </div>

    <div class="form-group">
        <label asp-for="ProductViewModel.ProductType">Τύπος</label>
        <select class="form-control" onchange="removeChoiceOption(this);" asp-for="ProductViewModel.ProductType" asp-items="Model.ProductType">
            <option disabled value="-1">--- Επιλογή ---</option>
        </select>
    </div>

    <div class="form-group">
        <label asp-for="ProductViewModel.SupplierId">Προμηθευτής</label>
        <span class="text-danger">@Model.SupplierNotActiveMessage</span>
        <select class="form-control" onchange="removeChoiceOption(this);" asp-for="ProductViewModel.SupplierId" asp-items="Model.Suppliers">
            <option disabled value="-1">--- Επιλογή ---</option>
        </select>
    </div>

    <div class="text-info">Τιμή ανα κιλό, λίτρο ή τεμάχιο:</div>
    <div class="form-inline">
        <label asp-for="ProductViewModel.PriceEuroPart">Eυρώ&nbsp;&nbsp;</label>
        <input asp-for="ProductViewModel.PriceEuroPart" class="form-control" />
        <span class="text-danger" asp-validation-for="ProductViewModel.PriceEuroPart"></span>
    </div>
    <div class="form-inline">
        <label asp-for="ProductViewModel.PriceCentsPart">Λεπτά&nbsp;</label>
        <input asp-for="ProductViewModel.PriceCentsPart" class="form-control" />
        <span class="text-danger" asp-validation-for="ProductViewModel.PriceCentsPart"></span>
    </div>
    <br />
    <div class="form-group">
        <label asp-for="ProductViewModel.ProductFreshness">Παραγγελία Πριν</label>
        @*<input asp-for="ProductViewModel.OrderWindow" class="form-control" />*@
        <select class="form-control" onchange="removeChoiceOption(this);" asp-for="ProductViewModel.ProductFreshness" asp-items="Model.ProductFreshness">
            <option disabled value="-1">--- Επιλογή ---</option>
        </select>
        <span class="text-danger" asp-validation-for="ProductViewModel.ProductFreshness"></span>

    </div>

    <button type="submit" onclick="setStorage();" class="btn btn-primary">Save</button>
</form>

@section Scripts
{
    <partial name="_ValidationScriptsPartial" />
}




<script type="text/javascript">

    $(function () {

        localStorage.removeItem('modifiedProductId');

        var measuringUnitId = '#'.concat('@Html.IdFor(o => o.ProductViewModel.MeasuringUnit)');
        var productTypeId = '#'.concat('@Html.IdFor(o => o.ProductViewModel.ProductType)');
        var supplierId = '#'.concat('@Html.IdFor(o => o.ProductViewModel.SupplierId)');

        var hiddernInputId = '#'.concat('@Html.IdFor(o => o.ProductViewModel.Id)');
        var productId = $(hiddernInputId).val();
        if (productId > 0) {
            $(measuringUnitId.concat(" option[value='-1']")).remove();
            $(productTypeId.concat(" option[value='-1']")).remove();
            $(supplierId.concat(" option[value='-1']")).remove();
            return;
        }

        $(measuringUnitId).val('-1');
        $(productTypeId).val('-1');
        $(supplierId).val('-1');
    });

    function removeChoiceOption(selectObj) {
        $('#'.concat(selectObj.id.concat(" option[value='-1']"))).remove();
    }

    function setStorage() {
        var hiddernInputId = '#'.concat('@Html.IdFor(o => o.ProductViewModel.Id)');
        var productId = $(hiddernInputId).val();
        if (productId < 1)
            productId = 0;
    
        localStorage.setItem('modifiedProductId', productId);
    }

</script>